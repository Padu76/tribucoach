
<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quiz TribuCoach con Salvataggio</title>
  <style>
    body { font-family: 'Poppins', sans-serif; background: #121212; color: #fff; margin: 0; padding: 20px; }
    .container { max-width: 800px; margin: auto; background: #1e1e1e; padding: 20px; border-radius: 12px; }
    h1, h2 { color: #ff9800; text-align: center; }
    .question { margin: 30px 0; }
    .question p { margin: 10px 0; }
    button { display: block; width: 100%; margin: 8px 0; padding: 12px; background: linear-gradient(45deg, orange, red); border: none; border-radius: 8px; color: #fff; font-size: 1rem; cursor: pointer; }
    button:hover { opacity: 0.9; }
    .hidden { display: none; }
    .result { margin-top: 30px; padding: 20px; background: #333; border-radius: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üèÜ Quiz TribuCoach</h1>

    <div id="quiz">
      <div class="question">
        <h2>Allenamento</h2>
        <p>Quante volte ti alleni a settimana?</p>
        <button onclick="answer('0-1', 2)">0-1</button>
        <button onclick="answer('2-3', 2)">2-3</button>
        <button onclick="answer('4-5', 2)">4-5</button>
        <button onclick="answer('6+', 2)">6+</button>
      </div>

      <div class="question hidden">
        <p>Quanto sono intensi i tuoi allenamenti?</p>
        <button onclick="answer('Leggeri', 3)">Leggeri</button>
        <button onclick="answer('Moderati', 3)">Moderati</button>
        <button onclick="answer('Intensi', 3)">Intensi</button>
      </div>

      <div class="question hidden">
        <h2>Alimentazione</h2>
        <p>Quanto segui un piano alimentare?</p>
        <button onclick="answer('Mai', 4)">Mai</button>
        <button onclick="answer('A volte', 4)">A volte</button>
        <button onclick="answer('Quasi sempre', 4)">Quasi sempre</button>
        <button onclick="answer('Sempre', 4)">Sempre</button>
      </div>

      <div class="question hidden">
        <p>Quanta acqua bevi al giorno?</p>
        <button onclick="answer('Meno di 1L', 5)">Meno di 1L</button>
        <button onclick="answer('1-1,5L', 5)">1-1,5L</button>
        <button onclick="answer('1,5-2L', 5)">1,5-2L</button>
        <button onclick="answer('Pi√π di 2L', 5)">Pi√π di 2L</button>
      </div>

      <div class="question hidden">
        <h2>Motivazione</h2>
        <p>Ti senti motivato a raggiungere i tuoi obiettivi?</p>
        <button onclick="answer('Per niente', 6)">Per niente</button>
        <button onclick="answer('Poco', 6)">Poco</button>
        <button onclick="answer('Abbastanza', 6)">Abbastanza</button>
        <button onclick="answer('Molto', 6)">Molto</button>
      </div>

      <div class="question hidden">
        <h2>Qualit√† del Sonno</h2>
        <p>Ti svegli riposato?</p>
        <button onclick="showResult('Mai')">Mai</button>
        <button onclick="showResult('Raramente')">Raramente</button>
        <button onclick="showResult('A volte')">A volte</button>
        <button onclick="showResult('Quasi sempre')">Quasi sempre</button>
      </div>
    </div>

    <div id="result" class="result hidden">
      <h2>üéØ Profilo Benessere Completo</h2>
      <p>Grazie per aver completato il quiz! Le tue risposte sono state salvate con successo e saranno utilizzate per personalizzare la tua esperienza. Continua cos√¨!</p>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDSsQEPii_Eb99cWGs7eqozgTtIqbtO2rs",
      authDomain: "tribucoach-9564b.firebaseapp.com",
      projectId: "tribucoach-9564b",
      storageBucket: "tribucoach-9564b.appspot.com",
      messagingSenderId: "476626832985",
      appId: "1:476626832985:web:7835188f40f4348567ab48"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let responses = [];

    window.answer = function(answerText, nextQ) {
      responses.push(answerText);
      next(nextQ);
    };

    window.showResult = async function(finalAnswer) {
      responses.push(finalAnswer);
      await saveQuizData(responses);
      document.getElementById("quiz").classList.add("hidden");
      document.getElementById("result").classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    function next(n) {
      const questions = document.querySelectorAll('.question');
      questions.forEach(q => q.classList.add('hidden'));
      questions[n-1].classList.remove('hidden');
    }

    async function saveQuizData(responses) {
      try {
        await addDoc(collection(db, "leads"), {
          responses: responses,
          timestamp: serverTimestamp()
        });
        console.log("Dati quiz salvati su Firebase:", responses);
      } catch (e) {
        console.error("Errore salvataggio quiz:", e);
      }
    }
  </script>
</body>
</html>
