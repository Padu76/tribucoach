<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz TribuCoach - Debug</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #000 0%, #1a1a1a 100%);
            color: #fff;
            min-height: 100vh;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.8rem;
            background: linear-gradient(135deg, #ff6600, #ff9933);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .debug-panel {
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 40px;
            border: 2px solid #ff6600;
        }

        .debug-panel h3 {
            color: #ff6600;
            margin-bottom: 15px;
        }

        .debug-panel button {
            background: #ff6600;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            margin: 5px;
            cursor: pointer;
        }

        .question-container {
            background: rgba(255,255,255,0.05);
            border-radius: 25px;
            padding: 50px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,102,0,0.2);
        }

        .question-title {
            font-size: 2.2rem;
            color: #ff6600;
            margin-bottom: 15px;
            text-align: center;
        }

        .question-subtitle {
            color: #ccc;
            text-align: center;
            margin-bottom: 35px;
            font-size: 1.2rem;
        }

        .input-group {
            margin-bottom: 25px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            color: #ff6600;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .input-group input {
            width: 100%;
            padding: 18px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            color: #fff;
            font-size: 1.1rem;
        }

        .input-group input:focus {
            outline: none;
            border-color: #ff6600;
        }

        .btn {
            padding: 18px 35px;
            border-radius: 30px;
            border: none;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff6600, #ff4400);
            color: white;
        }

        .btn-primary:disabled {
            background: #666;
            cursor: not-allowed;
        }

        .validation-status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
        }

        .validation-status.valid {
            background: rgba(76, 175, 80, 0.2);
            border: 2px solid #4CAF50;
            color: #4CAF50;
        }

        .validation-status.invalid {
            background: rgba(244, 67, 54, 0.2);
            border: 2px solid #f44336;
            color: #f44336;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Quiz TribuCoach - Debug</h1>
            <p>Versione di debug per identificare il problema</p>
        </div>

        <div class="debug-panel">
            <h3>üîß Debug Panel</h3>
            <button onclick="testValidation()">Test Validazione</button>
            <button onclick="forceEnable()">Forza Attivazione</button>
            <button onclick="showValues()">Mostra Valori</button>
            <button onclick="testFirebase()">Test Firebase</button>
            
            <div id="debug-output" style="margin-top: 15px; color: #ccc; font-family: monospace;"></div>
        </div>

        <div class="question-container">
            <h2 class="question-title">Parlami di te</h2>
            <p class="question-subtitle">Questi dati mi aiutano a creare il tuo profilo personalizzato</p>
            
            <div class="input-group">
                <label for="name">Nome completo:</label>
                <input type="text" id="name" placeholder="Come ti chiami?" value="luca">
            </div>
            
            <div class="input-group">
                <label for="email">Email:</label>
                <input type="email" id="email" placeholder="La tua email" value="padu76@hotmail.com">
            </div>
            
            <div class="input-group">
                <label for="age">Et√†:</label>
                <input type="number" id="age" min="16" max="80" placeholder="Quanti anni hai?" value="44">
            </div>

            <div class="input-group">
                <label for="city">Citt√†:</label>
                <input type="text" id="city" placeholder="Dove vivi?" value="Verona">
            </div>

            <div class="validation-status" id="validation-status">
                Status validazione: In attesa...
            </div>

            <button class="btn btn-primary" id="next-btn" disabled>
                Avanti ‚Üí
            </button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        console.log('üéØ Debug Quiz caricato');

        let db = null;

        // Configurazione Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDSsQEPii_Eb99cWGs7eqozgTtIqbtO2rs",
            authDomain: "tribucoach-9564b.firebaseapp.com",
            projectId: "tribucoach-9564b",
            storageBucket: "tribucoach-9564b.firebasestorage.app",
            messagingSenderId: "476626832985",
            appId: "1:476626832985:web:7835188f40f4348567ab48",
            measurementId: "G-YZ565MKQ6V"
        };

        // Inizializza Firebase
        function initFirebase() {
            try {
                if (typeof firebase !== 'undefined') {
                    const app = firebase.initializeApp(firebaseConfig);
                    db = firebase.firestore();
                    console.log('‚úÖ Firebase inizializzato');
                    return true;
                } else {
                    console.warn('‚ö†Ô∏è Firebase SDK non caricato');
                    return false;
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è Errore Firebase:', error.message);
                return false;
            }
        }

        function validateForm() {
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const age = parseInt(document.getElementById('age').value);
            const city = document.getElementById('city').value.trim();

            const validations = {
                name: name.length > 0,
                email: email.length > 0 && email.includes('@'),
                age: age >= 16 && age <= 80,
                city: city.length > 0
            };

            const isValid = Object.values(validations).every(v => v);

            // Aggiorna status visivo
            const statusDiv = document.getElementById('validation-status');
            const nextBtn = document.getElementById('next-btn');

            if (isValid) {
                statusDiv.className = 'validation-status valid';
                statusDiv.textContent = '‚úÖ Tutti i campi sono validi!';
                nextBtn.disabled = false;
            } else {
                statusDiv.className = 'validation-status invalid';
                statusDiv.textContent = '‚ùå Alcuni campi non sono validi';
                nextBtn.disabled = true;
            }

            return { isValid, validations, values: { name, email, age, city } };
        }

        function log(message) {
            const output = document.getElementById('debug-output');
            output.innerHTML = message + '<br>' + output.innerHTML;
            console.log(message);
        }

        // Funzioni debug globali
        window.testValidation = function() {
            log('üîç Testing validation...');
            const result = validateForm();
            log('üìä Validation result: ' + JSON.stringify(result, null, 2));
        };

        window.forceEnable = function() {
            log('üöÄ Forcing button enable...');
            const nextBtn = document.getElementById('next-btn');
            nextBtn.disabled = false;
            log('‚úÖ Button enabled');
        };

        window.showValues = function() {
            log('üìã Current values:');
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const age = document.getElementById('age').value;
            const city = document.getElementById('city').value;
            
            log('Name: "' + name + '" (length: ' + name.length + ')');
            log('Email: "' + email + '" (length: ' + email.length + ')');
            log('Age: "' + age + '" (parsed: ' + parseInt(age) + ')');
            log('City: "' + city + '" (length: ' + city.length + ')');
        };

        window.testFirebase = function() {
            if (!db) {
                log('‚ùå Firebase not initialized');
                return;
            }
            
            log('üß™ Testing Firebase...');
            db.collection('test').add({
                test: true,
                timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                message: 'Debug test'
            }).then((docRef) => {
                log('‚úÖ Firebase test successful! ID: ' + docRef.id);
            }).catch((error) => {
                log('‚ùå Firebase test failed: ' + error.message);
            });
        };

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ DOM loaded');
            
            // Inizializza Firebase
            initFirebase();
            
            // Setup input listeners
            const inputs = document.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    log('üìù Input changed: ' + this.id + ' = "' + this.value + '"');
                    setTimeout(validateForm, 10);
                });
                input.addEventListener('change', validateForm);
                input.addEventListener('keyup', validateForm);
            });

            // Setup button
            document.getElementById('next-btn').addEventListener('click', function() {
                log('üîò Next button clicked');
                const result = validateForm();
                if (result.isValid) {
                    log('‚úÖ Proceeding to next question...');
                    alert('Validazione OK! Procedendo alla domanda 2...');
                } else {
                    log('‚ùå Validation failed');
                    alert('Compilare tutti i campi correttamente');
                }
            });

            // Validazione iniziale
            setTimeout(() => {
                log('üîç Initial validation...');
                validateForm();
            }, 500);

            log('‚úÖ Debug quiz initialized');
        });
    </script>
</body>
</html>